# 闭包本质

闭包表达式：{(参数1，参数2) in 闭包内容}

### 闭包简写

一个函数和他捕获的变量\常量环境组合起来,称为闭包

函数可以为正常函数或者是闭包表达式



可以把闭包想象成是一个类的实例对象

内存在堆空间

捕获的局部变量\常量就是对象的成员

组成闭包的函数就是类内部定义的方法

### 尾随闭包







```swift
func fun() ->FN {
    var n = 0  //如果捕获两个变量 是两次开辟空间alloc 存在两个不同的堆空间
    func fn(c:Int) ->Int {
        n = n + c
        return n
    }
    return fn;
}

var fn = fun()  //fn占16个字节 前8位是fn的地址 后8位为堆空间的地址
fn(1)  	//1
fn(2)  	//3
fn(3) 	//6
fn(4) 	//10


func fun2() ->FN {
    var n = 0
    func fn(c:Int) ->Int {
        return c
    }
    return fn;
}

var fn = fun2()  //fn占16个字节 前8位是fn的地址 后8位为0
fn(1)  	//1
fn(2)  	//2
fn(3) 	//3
fn(4) 	//4
```

### 原因



####  1、内存上区别

n 被捕获  在堆内存开辟空间存储n 

捕获的时机  调用后 return前

  x/5xg x16进制  g8个字节为一组